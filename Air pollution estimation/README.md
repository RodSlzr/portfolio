# Air Pollution Forecast using a Random Forest Regressor

## By Rodrigo Salazar

Air pollution is a pervasive global issue that poses significant risks to human health and the environment. According to the World Health Organization, ambient air pollution was responsible for an estimated 4.2 million premature deaths worldwide in 2019. Monitoring the levels of pollutants in the air is crucial for addressing this problem effectively.

Among the various pollutants, PM 2.5 (particulate matter with a diameter of 2.5 micrometers or less) is particularly concerning due to its adverse health effects. Its presence in the atmosphere can be influenced by seasonal climate factors, industrial activities, and urban development.

### Introduction

Air pollution is a pervasive global issue that poses significant risks to human health and the environment. According to the World Health Organization, ambient air pollution was responsible for an estimated 4.2 million premature deaths worldwide in 2019. Monitoring the levels of pollutants in the air is crucial for addressing this problem effectively.

Among the various pollutants, PM 2.5 (particulate matter with a diameter of 2.5 micrometers or less) is particularly concerning due to its adverse health effects. Its presence in the atmosphere can be influenced by seasonal climate factors, industrial activities, and urban development.

To tackle this problem, continuous monitoring of air pollution data is essential. Many regions around the world have implemented policies that regulate car usage and outdoor activities based on air quality levels. However, there exists a significant disparity in the distribution of air pollution sensors globally, as illustrated by the map above. This disparity hinders accurate and widespread assessment of PM 2.5 levels.

![World Map Sensors](https://github.com/macs30123-s23/final-project-final-project-rodslzr/blob/main/world_map.png)

To address the lack of comprehensive PM 2.5 data and provide an alternative solution. This project aims to explore the use of Machine Learning (ML). By leveraging location, time, and information from existing sensors, with ML models we could potentially estimate PM 2.5 levels in regions with limited sensor coverage. Additionally, in areas where sensor data is available, ML models can serve as backup tools for verification and calibration purposes.

The focus of this project is Mexico, where despite having several hundred sensors, many areas lack adequate coverage. Furthermore, Mexico's diverse climate conditions present an additional challenge that results useful to understand the limitations and opportunities in the development of accurate PM 2.5 estimation models.

![Mexico Sensors](https://github.com/macs30123-s23/final-project-final-project-rodslzr/blob/main/mex_map.png)

The use of scalable computing is imperative for this task due to the immense amount of data generated by sensors worldwide. With sensors constantly reporting data from various locations, processing and analyzing this vast volume of information require substantial computational resources. To overcome these challenges, I employed an AWS EMR cluster with a Spark kernel to establish a robust pipeline for data analysis, model creation, and evaluation.

Furthermore, the scalability of the proposed architecture is crucial to handle real-time processing of incoming sensor data. This capability ensures that the system remains capable of accommodating future data streams while maintaining its efficiency and accuracy.

By employing a Random Forest Regressor model in this project, we aim to demonstrate the potential of Machine Learning in estimating PM 2.5 levels and contributing to the monitoring and management of air pollution, particularly in regions with limited sensor coverage.

### Methodology

#### Data Collection

In this project, the OpenAQ data from the Registry of Open Data of AWS was utilized. This dataset offers comprehensive and aggregated physical air quality data from various sources, including government, research-grade, and other publicly available data sources. The efforts of these groups in measuring and sharing this data have significantly contributed to its accessibility on a global scale.

To focus specifically on Mexico and ensure a relevant and recent dataset, the data request was limited to information from March to May 2023. Purple Air, being one of the prominent providers of air pollution data worldwide, was chosen as the data provider. By leveraging Purple Air's extensive network, which includes a large number of air quality sensors, the dataset obtained for this project consisted of nearly 19 million rows of data.

This approach not only allowed for the utilization of a rich and up-to-date dataset but also facilitated the examination of air pollution patterns and trends during a specific time period in Mexico. By harnessing the data provided by Purple Air, the project aimed to capture the diverse environmental conditions and challenges faced by different regions in the country.

#### Data Cleansing

During the data preparation stage of the project, certain transformations were required due to the nature of the data obtained, which initially arrived as strings.By converting the relevant string values into appropriate numerical formats, such as integers or floating-point numbers, the data could be processed and utilized effectively. This step involved parsing and extracting the essential information from the strings, such as pollutant concentrations, timestamps, and sensor locations.

Furthermore, to provide meaningful insights and facilitate the interpretation of PM 2.5 levels, an additional variable called "category" was created. This variable classified the PM 2.5 levels into distinct categories, namely 'Good', 'Moderate', and 'Unhealthy'. The categorization was based on the classification proposed by Du (2016), which considers specific thresholds or guidelines to determine the air quality level associated with PM 2.5 concentrations.

Assigning these categories allowed for a simplified representation of PM 2.5 levels, making it easier to interpret and communicate the air quality conditions. This classification scheme, based on established guidelines, enabled comparisons and assessments of the severity of air pollution in different regions and time periods.

#### Data Exploration

After analyzing the distribution of the PM 2.5 values, it became evident that the majority of the data points fell within the 'Good' and 'Moderate' air quality levels. The distribution exhibited a non-symmetrical and right-skewed shape.

![PM25 Distribution](https://github.com/macs30123-s23/final-project-final-project-rodslzr/blob/main/values_dist.png)

This observation indicated that the dataset was unbalanced, which could potentially pose challenges for the model's performance and accuracy. To address this issue, a resampling technique was employed to rebalance the data and alleviate the impact of the class imbalance. This technique aimed to ensure that the model receives sufficient representation of different air quality levels during training, thus mitigating any bias towards the dominant classes.

Additionally, recognizing the importance of spatial information in understanding air quality, the data was visualized using latitude and longitude coordinates. By plotting the data points on a map, the relationship between location and air quality could be explored. This visualization allowed for the identification of geographical patterns, hotspots, or areas with consistently higher or lower PM 2.5 levels. By considering the spatial aspect, it became possible to gain insights into the spatial distribution of air pollution and its potential drivers, such as industrial zones, traffic congestion, or geographical features.

![Location vs PM5](https://github.com/macs30123-s23/final-project-final-project-rodslzr/blob/main/air_pollution_location.png)

Upon analyzing the plot, we observe that the air pollution classification is not perfectly separated across all locations. This finding challenges any preconceived notions we might have had, considering that air pollutants can travel and disperse over long distances. However, it is important to note that there are specific regions where we observe strikingly similar trends in air pollution classification.

These regions with similar trends provide an intriguing opportunity for forecasting and prediction. The consistent patterns suggest that certain local factors or characteristics may influence air pollution levels, resulting in comparable classifications. By identifying and understanding these factors, we can potentially develop accurate forecasts for air pollution in these regions.

It is worth noting that while the overall data does not exhibit clear separation, the presence of localized patterns is promising. This implies that our model or predictive approach could be effective in these specific regions. By leveraging these localized trends, we can enhance our forecasting capabilities and provide targeted interventions and measures to mitigate air pollution.

#### Modeling

To forecast PM 2.5 levels, a Random Forest Regressor was selected as the primary algorithm. The Random Forest Regressor is an ensemble learning method that combines multiple decision trees, each trained on different subsets of the training data. The final prediction is obtained by aggregating the predictions of all individual trees in the ensemble.

One advantage of the Random Forest Regressor is its ability to reduce overfitting by introducing randomness during the training process. Each tree in the ensemble is built using a random subset of features and samples from the training data. This randomness helps to decorrelate the trees and increases the diversity of the ensemble, leading to improved generalization performance.

While exploring alternative regression and classification models, it was observed that most of them yielded unsatisfactory results, with predictions close to random guessing (1/3) or poor performance indicated by the confusion matrices. This suggests that these models may not capture the complex relationships and patterns present in the PM 2.5 data effectively.

The Random Forest Regressor, on the other hand, demonstrated promising performance in estimating PM 2.5 levels. Its ability to handle non-linear relationships, deal with high-dimensional data, and mitigate overfitting made it a suitable choice for this project.

#### Results

![COnfussion Matrix](https://github.com/macs30123-s23/final-project-final-project-rodslzr/blob/main/conf_matrix.png)

Based on our analysis using random forest regression, we achieved an accuracy of 48%, which is significantly better than random guessing with a probability of 1/3. This indicates that our model has demonstrated some level of predictive power in forecasting climate factors.

Considering the inherent complexity involved in climate forecasting, we can consider this accuracy level to be a favorable outcome. It suggests that our model has captured certain patterns and relationships within the data that contribute to accurate predictions.

Furthermore, when examining the Confusion Matrix, we observed interesting patterns. In the 'Good' and 'Unhealthy' classifications, our model made the second most popular predictions within their respective categories. Additionally, we noticed minimal instances of misclassifications in the farthest categories. These findings suggest that our model's performance goes beyond what can be solely assessed based on accuracy alone.

Overall, our results indicate that the random forest regression model has provided valuable insights and demonstrated promise in forecasting climate factors. Further refinement and exploration of the model could potentially enhance its predictive capabilities.

#### Conclusion

The successful implementation of Machine Learning models for air quality estimation can contribute to creating a more breathable world for everyone. Accurate and timely information about air pollution levels is crucial for policymakers, public health officials, and individuals to make informed decisions and take necessary actions to mitigate the harmful effects of air pollution.

Further advancements in this field can lead to the development of more sophisticated models that account for various factors influencing air quality, such as meteorological conditions, emissions from different sources, and geographical features. By integrating these factors, the models can provide a more comprehensive understanding of air pollution dynamics and aid in the formulation of effective strategies for pollution control and prevention.

In conclusion, the utilization of Machine Learning models in air pollution estimation shows great promise and opens doors to creating a more sustainable and healthier environment for everyone. Continued research and advancements in this area can contribute to achieving the goal of improving air quality and ensuring a better quality of life for future generations.

#### References

-World Health Organization. "Ambient (outdoor) air quality and health." World Health Organization. 2023, May 26. https://www.who.int/news-room/fact-sheets/detail/ambient-(outdoor)-air-quality-and-health.

-Du, Xu & Varde, Aparna. (2016). Mining PM2.5 and traffic conditions for air quality. 33-38. 10.1109/IACS.2016.7476082. 

Data: 

-OpenAQ was accessed on 05/26/2023 from https://registry.opendata.aws/openaq.

-[AWS OpenData - OpenAQ](https://registry.opendata.aws/openaq/)

-[OpenAQ Portal](https://explore.openaq.org/)

-[OpenAQ Documentation](https://docs.openaq.org/docs/accessing-openaq-archive-data#bucket-structure)
